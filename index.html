<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital System Design App</title>
    <style>
        body { 
            font-family: 'Roboto', sans-serif;
            background-color: #1e1e1e;
            margin: 0;
            padding: 0;
            color: #dcdcdc;
        }

        .container, .button-container {
            text-align: center;
            margin-top: 15%;
            background-color: rgba(30, 30, 30, 0.85);
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            padding: 40px;
        }

        h1 {
            color: #00ccff;
            font-size: 36px;
        }

        h2 {
            color: #00ccff;
            font-size: 28px;
        }

        p {
            color: #b0b0b0;
            font-size: 18px;
        }

        .button-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        button {
            padding: 5px 10px;
            border: none;
            border-radius: 8px;
            background-color: #00ccff;
            color: #1e1e1e;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
            height: 60px; /* Fixed height for buttons to ensure uniform size */
        }

        button:hover {
            background-color: #008fb3;
            transform: scale(1.05);
        }

        input[type="text"] {
            width: 100%;
            height: 40px;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #00ccff;
            border-radius: 5px;
            font-size: 16px;
        }

        pre {
            background-color: #2d2d2d;
            color: #00ccff;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap; /* Allow text to wrap */
            word-wrap: break-word; /* Break long words if necessary */
            margin-top: 20px; /* Space above the Verilog output */
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 10px; /* Space between buttons */
        }
    </style>
</head>
<body>
    <div id="welcomePage">
        <div class="container">
            <h1>Welcome!</h1>
            <p>App designed for DSD</p>
            <p>Faculty: Dr. Dhanabal R</p>
            <p>By A S Rassel (23BML0051) & Ayush Jaiswal (23BEC0204)</p>
        </div>
    </div>

    <div id="buttonContainer" class="button-container" style="display:none;">
        <h1>Choose from the Options</h1>
        <div class="button-grid">
            <button id="button1">DATA FLOW MODEL</button>
            <button id="button2">BEHAVIOURAL MODEL(CASE)</button>
            <button id="button3">MUX</button>
            <button id="button4" onclick="openDemuxPage()">DEMUX</button> <!-- DEMUX button -->
            <button id="button5">DECODER</button>
            <button id="button6">NAND LOGIC</button>
            <button id="button7">NOR LOGIC</button>
            <button id="button8">AOI</button>
            <button id="button9">OAI</button>
        </div>
    </div>

    <div id="regNumberPage" style="display:none;">
        <div class="container">
            <h2>Enter Your Registration Number</h2>
            <input type="text" id="regNumber" placeholder="Enter Reg Number" />
            <div class="button-container">
                <button id="generateCode">Generate Code</button>
                <button id="copyButton">Copy Code</button>
                <button id="openJdoodle">Open JDoodle</button>
            </div>
            <pre id="verilogOutput"></pre>
        </div>
    </div>

    <script>
        // Automatically transition from the welcome page to the button page after 2 seconds
        setTimeout(function() {
            document.getElementById("welcomePage").style.display = "none"; // Hide the welcome page
            document.getElementById("buttonContainer").style.display = "block"; // Show the button page
        }, 2000); // 2000 milliseconds = 2 seconds

        // Event listener for DATA FLOW MODEL button
        document.getElementById("button1").addEventListener("click", function() {
            document.getElementById("buttonContainer").style.display = "none"; // Hide button page
            document.getElementById("regNumberPage").style.display = "block"; // Show registration page
        });

        // Event listener for BEHAVIOURAL MODEL button
        document.getElementById("button2").addEventListener("click", function() {
            window.open("behavioural_model.html", "_blank"); // Open the new webpage for Behavioral Model
        });

        // Event listener for MUX button
        document.getElementById("button3").addEventListener("click", function() {
            window.open("mux.html", "_blank"); // Open the new webpage for MUX
        });

        // Function to open the DEMUX page
        function openDemuxPage() {
            window.open("demux.html", "_blank"); // Open the new webpage for DEMUX
        }

        // Event listener for generating Verilog code for DATA FLOW MODEL
        document.getElementById("generateCode").addEventListener("click", function() {
            const regNumber = document.getElementById("regNumber").value.trim().toUpperCase();
            const minterms = [];

            // Hexadecimal mapping for A to F
            const hexMap = {
                'A': 10,
                'B': 11,
                'C': 12,
                'D': 13,
                'E': 14,
                'F': 15
            };

            // Determine the minterms based on the registration number
            for (let char of regNumber) {
                if (!isNaN(parseInt(char))) {
                    minterms.push(parseInt(char)); // Numbers 0-9
                } else if (hexMap[char] !== undefined) {
                    minterms.push(hexMap[char]); // Hexadecimal letters A-F
                }
            }

            // Remove duplicates from the minterms array
            const uniqueMinterms = [...new Set(minterms)];

            // Generate Verilog code based on the minterms
            let verilogCode = "module logic_function(\n";
            verilogCode += "    input A, B, C, D,\n"; // Example inputs
            verilogCode += "    output F\n";
            verilogCode += ");\n";
            verilogCode += "    assign F = ";

            // Create a logic expression based on the unique minterms
            const terms = uniqueMinterms.map(m => {
                const binary = m.toString(2).padStart(4, '0'); // Convert to binary
                let term = '('; // Start with an opening parenthesis

                for (let j = 0; j < binary.length; j++) {
                    if (binary[j] === '1') {
                        term += `${String.fromCharCode(65 + j)}`; // A, B, C, D
                    } else {
                        term += `~${String.fromCharCode(65 + j)}`; // ~A, ~B, ~C, ~D
                    }

                    // Add '&' between terms except for the last one
                    if (j < binary.length - 1) {
                        term += ' & ';
                    }
                }

                term += ')'; // Close the parenthesis
                return term; // Return the term for the minterm
            }).join(' | '); // Join with '|' to create ORed terms

            verilogCode += terms + ";\n";
            verilogCode += "endmodule\n\n";

            // Testbench generation
            verilogCode += "module testbench;\n";
            verilogCode += "    reg A, B, C, D;\n";
            verilogCode += "    wire F;\n";
            verilogCode += "    logic_function lf(A, B, C, D, F);\n\n";
            verilogCode += "    initial begin\n";
            verilogCode += "        $monitor(\"Time: %0t | A: %b | B: %b | C: %b | D: %b | F: %b\", $time, A, B, C, D, F);\n";

            // Test all combinations of A, B, C, D
            for (let i = 0; i < 16; i++) {
                const binary = i.toString(2).padStart(4, '0');
                verilogCode += `        A = ${binary[0]}; B = ${binary[1]}; C = ${binary[2]}; D = ${binary[3]}; #10;\n`;
            }

            verilogCode += "        $finish;\n";
            verilogCode += "    end\n";
            verilogCode += "endmodule\n";

            // Output the generated Verilog code
            document.getElementById("verilogOutput").textContent = verilogCode;
        });

        // Copy code to clipboard
        document.getElementById("copyButton").addEventListener("click", function() {
            const code = document.getElementById("verilogOutput").textContent;
            navigator.clipboard.writeText(code).then(function() {
                alert("Code copied to clipboard!");
            }).catch(function(err) {
                console.error("Failed to copy text: ", err);
            });
        });

        // Open JDoodle with generated code
        document.getElementById("openJdoodle").addEventListener("click", function() {
            const code = document.getElementById("verilogOutput").textContent;
            const jdoodleURL = `https://www.jdoodle.com/embed/v0/Verilog-CoSim/?code=${encodeURIComponent(code)}`;
            window.open(jdoodleURL, "_blank");
        });
    </script>
</body>
</html>
